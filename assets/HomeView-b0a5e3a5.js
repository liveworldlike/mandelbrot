import{d as O,r as k,o as he,a as Y,c as Ie,b as h,w as Ae,F as Ce,e as Be,__tla as xe}from"./index-1d90839c.js";let F,De=Promise.all([(()=>{try{return xe}catch{}})()]).then(async()=>{const X="/assets/wasm_mandelbrot_bg-65dc9887.wasm",q=async(l={},a)=>{let d;if(a.startsWith("data:")){const o=a.replace(/^data:.*?base64,/,"");let f;if(typeof Buffer=="function"&&typeof Buffer.from=="function")f=Buffer.from(o,"base64");else if(typeof atob=="function"){const r=atob(o);f=new Uint8Array(r.length);for(let _=0;_<r.length;_++)f[_]=r.charCodeAt(_)}else throw new Error("Cannot decode base64-encoded data URL");d=await WebAssembly.instantiate(f,l)}else{const o=await fetch(a),f=o.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&f.startsWith("application/wasm"))d=await WebAssembly.instantiateStreaming(o,l);else{const r=await o.arrayBuffer();d=await WebAssembly.instantiate(r,l)}}return d.instance.exports};let g;function z(l){g=l}const H=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let R=new H("utf-8",{ignoreBOM:!0,fatal:!0});R.decode();let I=null;function E(){return(I===null||I.byteLength===0)&&(I=new Uint8Array(g.memory.buffer)),I}function V(l,a){return l=l>>>0,R.decode(E().subarray(l,l+a))}let A=null;function M(){return(A===null||A.byteLength===0)&&(A=new Int32Array(g.memory.buffer)),A}function G(l,a){return l=l>>>0,E().subarray(l/1,l/1+a)}function J(l,a,d,o,f,r,_,C){try{const v=g.__wbindgen_add_to_stack_pointer(-16);g.calculate_array(v,l,a,d,o,f,r,_,C);var B=M()[v/4+0],y=M()[v/4+1],w=G(B,y).slice();return g.__wbindgen_free(B,y*1),w}finally{g.__wbindgen_add_to_stack_pointer(16)}}function K(l,a){alert(V(l,a))}URL=globalThis.URL;const b=await q({"./wasm_mandelbrot_bg.js":{__wbg_alert_e99cde255edfe1a8:K}},X),N=b.memory,Q=b.test_array,Z=b.calculate_array,$=b.is_mandelbrot,ee=b.greet,te=b.__wbindgen_add_to_stack_pointer,ne=b.__wbindgen_free,ae=Object.freeze(Object.defineProperty({__proto__:null,__wbindgen_add_to_stack_pointer:te,__wbindgen_free:ne,calculate_array:Z,greet:ee,is_mandelbrot:$,memory:N,test_array:Q},Symbol.toStringTag,{value:"Module"}));z(ae);const le={id:"container"},re=["onMousedown"],oe={id:"ui-controls"},s=2e3,c=1e3,ie=O({__name:"Mandelbrot",setup(l){const a=k(null),d=k(null);let o=[0,0],f=[0,0],r=[s/c,1],_=[s/c,1];const C=k(50),B=new ImageData(new Uint8ClampedArray(s*c*4),s,c);let y=0,w=null;function v(){return a.value===null?[0,0]:[a.value.width/2,a.value.height/2]}function L(e){if(a.value===null)return[0,0];let t=v(),n=[(e[0]-t[0])/s,(-e[1]+t[1])/c],i=r,u=o;return[n[0]*i[0]+u[0],n[1]*i[1]+u[1]]}function P(){if(a.value===null)return null;let e=a.value.getContext("2d");return e===null?null:e}function x(){w!==null&&w.abort(),w=new AbortController;function e(n){return new Promise(i=>{setTimeout(i,n)})}async function t(n){await se(n),await e(500),!n.aborted&&await ce(n)}t(w.signal)}function ue(){let e=P();if(e===null||d.value===null)return;let t=_[0]/r[0],n=_[1]/r[1],i=-f[0]+o[0],u=-f[1]+o[1],m=-(i+(_[0]-r[0])/2)/r[0]*s,p=-(u-(_[1]-r[1])/2)/r[1]*c;e.setTransform(1,0,0,1,0,0),e.putImageData(B,0,0),e.scale(t,n),e.drawImage(d.value,m/t,-p/n),e.setTransform(1,0,0,1,0,0)}async function se(e){return new Promise(t=>{e.aborted&&t(null),e.addEventListener("abort",()=>{t(null)}),t(ue())})}async function ce(e){return new Promise(t=>{var S,j;y+=1;let n=y;console.log("Started render",n);let i=P();if(e.aborted&&(console.log("Render cancelled",n),t(null)),e.addEventListener("abort",()=>{console.log("aborted render",n),t(null)}),i===null)return;let[u,m]=L([0,0]),[p,U]=L([s,c]),W=ve(u,m,p,U,s,c,C.value),D=new ImageData(new Uint8ClampedArray(W),s,c);i.putImageData(D,0,0),(j=(S=d.value)==null?void 0:S.getContext("2d"))==null||j.putImageData(D,0,0),f=o,_=r,console.log("Finished render",n),t(null)})}function de(e,t){let n=L(e),i=o,u=r,m=[u[0]*t,u[1]*t];o=[n[0]-(n[0]-i[0])/u[0]*m[0],n[1]-(n[1]-i[1])/u[1]*m[1]],r=m}function fe(e){if(a.value===null)return[0,0];let t=a.value.getBoundingClientRect();return[(e[0]-t.left)*s/t.width,(e[1]-t.top)*c/t.height]}function _e(e){let t=fe([e.clientX,e.clientY]),n=1;e.deltaY<0?n*=.9:n/=.9,de(t,n),x()}function me(e,t){if(e==0&&t==0||a.value===null)return;let n=a.value.getBoundingClientRect(),i=o,u=-e/n.width*r[0],m=t/n.height*r[1];o=[i[0]+u,i[1]+m],x()}let T=!1;function ge(e){T=!0}function be(e){T&&me(e.movementX,e.movementY)}function we(e){T=!1}function ye(e,t,n,i,u,m,p){let U=BigInt(u),W=BigInt(m),D=BigInt(p);return J(e,t,n,i,U,W,D,2.1)}let ve=ye;async function pe(e){console.log(e.target.value),C.value=e.target.value,x()}return he(()=>{document.addEventListener("mousemove",be),document.addEventListener("mouseup",we),x()}),(e,t)=>(Y(),Ie(Ce,null,[h("div",le,[h("canvas",{ref_key:"canvas",ref:a,class:"fit-none",width:s,height:c,id:"canvas",onWheel:_e,onMousedown:Ae(ge,["left"])},null,40,re),h("canvas",{ref_key:"hiddenCanvas",ref:d,width:s,height:c,class:"hidden"},null,512)]),h("div",oe,[h("input",{type:"range",onInput:pe,min:"10",max:"1000",step:"10"},null,32)])],64))}});F=O({__name:"HomeView",setup(l){return(a,d)=>(Y(),Be(ie))}})});export{De as __tla,F as default};
